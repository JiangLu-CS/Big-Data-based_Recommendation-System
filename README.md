# Big-Data-based_Recommendation-System
A Big-Data-based real-time recommendation system
荐的数据流大致如图所示：

其中业务系统写日志，写redis的行为已经展示在前面的代码中，而flume的监听主要依靠配置文件中的路径与tail -F命令，所以也省略，spark Streaming的计算也已经在前面的代码中讲完，所以这里主要展示kafka到spark Streaming的数据流处理代码。
Kafka的处理主要是有一个from到to的处理过程，即加工 from的数据，并传输给to，最终运用到spark Streaming中去做运算。
第一步需要配置好，输入topic是flume输入的日志信息，输出topic是处理过的recommendation信息。配置好ip和端口。

拓扑构建器中的addProcessor是核心处理过程，需要重写一个logProcessor函数，用于处理输入的信息。

Process函数的处理过程如下，由于日志处理时，关于用户行为的日志有特定的前缀，所以过滤出用户行为，然后由于日志的记录有一定的格式，包括了userid和行为参数，所以需要处理并提取出有效信息。



在spark Streaming中监听kafka，配置好之后，就可以接收到已经处理的信息了。

接收到信息后对数据进行一个整合，可以看到整合了四个参数，由于日志信息是用|隔开的，这样split出来就能获取到有效信息了，并利用这些数据开始进行实时计算了。

计算完之后，把对应的用户的推荐列表发送到mongodb中，这样用户在下一次访问首页时，后端就会取得mongodb中实时推荐的最终数据，并完成实时推荐功能。
3.3部署
1.kafka，zookeeper
下载好kafka和zookeeper的安装包上传到服务器上，并解压，移动到local文件夹里，启动两个组件的服务，并在配置文件中配置好端口。Zookeeper为2181，kafka为9092.
启动服务




开发时即直接让kafka与zookeeper运行在服务器上，在运行时已经占据了该服务器70%的内存，清空消息也无效，所以部署其他的组件需要另开一台服务器。

2.MongoDB，Redis，MySQL
为了保证剩余的组件可以正常运行，所以开通一台4G内存的云服务器供部署。

部署MongoDB，Redis，MySQL等数据库服务，可以直接使用wget的方式进行下载，下载后解压，并移动到local文件夹中，把本地的数据上传到MongoDB和MySQL中，并分别开启他们的服务。

启动mongodb

测试mongodb远程连接，并上传数据，使用mongodb Compass

启动redis

Redis的远程连接需要修改配置文件，把bind 127.0.0.1注释掉。

启动MySQL

测试远程连接


部署流处理程序与实时推荐，内容推荐等
每一个都是单独的程序，所以分别生成jar包并上传。
使用build artifact的方式，然后用java -jar命令运行，设置为后台运行即可。

部署Springboot项目

先package生成jar包，然后上传到服务器上。然后通过运行java -jar命令，即可部署。

测试访问成功

四．测试报告
4.1用户功能测试
4.1.1 注册

注册成功

4.1.2 登录

输入手机号，密码，验证码，登陆成功


4.1.3 浏览商品

成功浏览
4.1.4 商品加入购物车


添加成功

4.1.5 支付


下单成功
4.1.7 收到支付邮件

4.1.8 查看个人信息

4.1.9 查看订单

4.2 销售人员测试
4.2.1目录管理（商品类别的添加和删除）

4.2.2商品类别信息修改

4.2.3销售状态信息的监控

4.2.4用户购买和浏览的日志记录

4.2.5管理订单

4.2.6 销量统计


4.3 管理员测试
4.3.1管理销售人员ID和登录口令

4.3.2商家日志
时间的显示貌似在前端出问题了，数据库中显示正常，后续会进行处理。


4.3.3管理员日志

4.3.4 用户日志

4.4 大数据推荐
4.4.1基于商品内容的推荐
显示在每一个商品的详情页面，可以看到相似商品确实很相似，都是同类甚至同品牌产品。


4.4.2基于用户行为的推荐
无用户登录时的默认界面


用户登录后的个性化推荐界面


用户13500028259，电脑，化妆品，护肤品都有。








用户13513513513 的个性化推荐，可以看到对口红和耳机比较感兴趣


用户135000000000 可以看到对耳机和手机比较感兴趣。


4.4.3基于用户行为与商品内容的实时推荐
新用户首次登录未产生行为，实时推荐处没有数据。


新用户点击首页的一个电脑

新用户返回首页并刷新页面，发现实时推荐都是电脑相关的商品推荐。说明实时系统运行正常

在浏览了手机之后：


刷新首页，可以看到推荐全部变成了手机，而且都是华为的牌子



点击苹果手机


返回首页并刷新，发现推荐的全变成了苹果手机。

